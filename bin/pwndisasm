#!/usr/bin/env python3
import sys
import capstone

from pyutils.shared_logic import parse_and_set_flags
parse_and_set_flags()

import pyutils.config as config
from pyutils.shared_logic import get_most_common_argparser
from pyutils.disassembly import disasm_opcodes

parser = get_most_common_argparser()
parser.add_argument('instr', type=lambda x: int(x, 16), nargs='+')
args = parser.parse_args()

first = True
for dis, instr in zip(disasm_opcodes(args.instr), args.instr):
    if not first:
        print()
    first = False
    print(f"{instr:08x}:")
    print(dis)
